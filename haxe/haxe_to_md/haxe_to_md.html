<html>
    <body>
        <table>
            <tbody>
                <tr>
                    <td colspan="2"><button onclick="md_creator()">vscode codedox haxe to md file shallow docs generator</button></td>
                </tr>
                <tr>
                    <td>
                        <textarea id="incoming" title="haxe with codedox syntax"></textarea>
                    </td>
                    <td>
                        <textarea id="output" title="md sytnax"></textarea>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
    <script>
    function monospace_creator(x){
        var rez = x.replace("\t"," ");
        rez = rez.replace("\n"," ");
        rez = rez.replace("\v"," ");
        rez = rez.replace("\f"," ");
        rez = rez.replace("\r"," ");
        rez = rez.replace(/ {1,}/g," ");
        return rez;
    }
    function text_extractor(x){
        var rez = x.split("@param")[0];
        rez = rez.split("@return")[0];
        rez = rez.split("*/")[0];
        rez = rez.replace("<","&lt;");
        rez = rez.replace(">","&gt;");
        rez = monospace_creator(rez);
        return rez;
    }
    function method_extractor(x){
        // console.log(x);
        var rez = x.split("*/",2)[1];
        // console.log(x.split("*/",1));
        rez = rez.split("{")[0];
        rez = rez.split(";")[0];
        rez = rez.split("=")[0];
        rez = rez.replace("<","&lt;");
        rez = rez.replace(">","&gt;");
        rez = monospace_creator(rez);
        return rez;
    }
    function md_builder(texts,methods){
        var rez = "";
        for(i=0;i<texts.length;i++){
            if (texts[i] != "" && methods[i] != ""){
                rez+="\n---\n"+methods[i]+"  \n"+texts[i];
            }
        }return rez;
    }
    function md_creator(){
        var haxecode = document.getElementById("incoming").value;
        var methods = []; //method syntax
        var texts = []; //description text
        var atext = haxecode.split("/**") ;
        for (i=1;i<atext.length;i++){
            texts.push(text_extractor(atext[i]));
            methods.push(method_extractor(atext[i]));
        }
        var md = md_builder(texts,methods);
        
        document.getElementById("output").value = md;
    }
    </script>
</html>